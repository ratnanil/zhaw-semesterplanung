---
title: "Semesterplanung"
format: gfm
---


FS
- Circular Economy Management (Di Nachmittag)
- Patterns and Trends (Mi Vormittag, 2. Quartal)
- Remote Sensing UI (Montag Vormittag, 2 Einheiten)
- ADLS Spatiotemproral DataScience (Di Vormittag)


HS
- Research Methods (Mo / Di Vormittag)
- ADLS Image Processing for Remote Sensing
- ADLS GIScience and Geodatabases
- UI Geospatial Computing
- ADLS DataLab


```{r}
library(readODS)
library(calendar)
library(tidyr)
library(dplyr)
library(lubridate)
library(ISOweek)
library(glue)
library(stringr)
library(purrr)
ISOweek2date(weekdate = "2025-W47-2")

year <- 2026
fs26 <- read_ods("Modultage.ods", "FS26") |> 
  fill(Studiengang, Modul, Weekday) |> 
  filter(is.na(Ex)) |> 
  select(-Ex)


events <- fs26 |>
  mutate(
    Kalenderwoche = str_pad(Kalenderwoche, 2, pad = "0"),
    isoweekdate = glue("{year}-W{Kalenderwoche}-{Weekday}"),
    date = ISOweek2date(isoweekdate),
    date_from = as.POSIXct(paste(date, Von), tz = "CET"),
    date_to = as.POSIXct(paste(date, Bis), tz = "CET"),
    summary = glue("{Studiengang}: {Modul} ({Topic})")
    # description = glue("{Topic}\n{Comment}", .na = "")
  )

# Create iCalendar events
ic_events <- events |>
  rowwise() |>
  mutate(
    event = list(ic_event(
      start_time = date_from,
      end_time = date_to,
      summary = summary,
      # event_properties = c(description = description)
    ))
  ) |>
  pull(event)



ic_events
# Combine all events into a single calendar

cal <- lapply(ic_events, ical)

names(cal) <- paste0(paste(events$Modul, events$Semesterwoche, events$Topic, sep = "_"), ".ics") |> 
  str_replace_all(" ","_") |> 
  str_replace_all("/","_")

# cal <- ical(ic_events[[1]])

# Write to .ics file

imap(cal, \(x,y){
  
  # browser()
  outfile <- file.path("ics", y)
  ic_write(x, outfile)
})






```




